<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform sensitivity analysis on fitted models — konfound • konfound</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform sensitivity analysis on fitted models — konfound" />
<meta property="og:description" content="For fitted models, this command calculates (1) how much bias there must be in an estimate to invalidate/sustain an inference; (2) the impact of an omitted variable necessary to invalidate/sustain an inference for a regression coefficient. Currently works for: models created with lm() (linear models)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">konfound</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction-to-konfound.html">Introduction to konfound</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jrosen48/konfound/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform sensitivity analysis on fitted models</h1>
    <small class="dont-index">Source: <a href='https://github.com/jrosen48/konfound/blob/master/R/konfound.R'><code>R/konfound.R</code></a></small>
    <div class="hidden name"><code>konfound.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For fitted models, this command calculates (1) how much bias there must be in an estimate to invalidate/sustain an inference; (2) the impact of an omitted variable necessary to invalidate/sustain an inference for a regression coefficient. Currently works for: models created with lm() (linear models).</p>
    </div>

    <pre class="usage"><span class='fu'>konfound</span><span class='op'>(</span>
  <span class='va'>model_object</span>,
  <span class='va'>tested_variable</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
  tails <span class='op'>=</span> <span class='fl'>2</span>,
  index <span class='op'>=</span> <span class='st'>"RIR"</span>,
  to_return <span class='op'>=</span> <span class='st'>"print"</span>,
  test_all <span class='op'>=</span> <span class='cn'>FALSE</span>,
  two_by_two <span class='op'>=</span> <span class='cn'>FALSE</span>,
  n_treat <span class='op'>=</span> <span class='cn'>NULL</span>,
  switch_trm <span class='op'>=</span> <span class='cn'>TRUE</span>,
  replace <span class='op'>=</span> <span class='st'>"control"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model_object</th>
      <td><p>output from a model (currently works for: lm)</p></td>
    </tr>
    <tr>
      <th>tested_variable</th>
      <td><p>Variable associated with the unstandardized beta coefficient to be tested</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>probability of rejecting the null hypothesis (defaults to 0.05)</p></td>
    </tr>
    <tr>
      <th>tails</th>
      <td><p>integer whether hypothesis testing is one-tailed (1) or two-tailed (2; defaults to 2)</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p>whether output is RIR or IT (impact threshold); defaults to "RIR"</p></td>
    </tr>
    <tr>
      <th>to_return</th>
      <td><p>whether to return a data.frame (by specifying this argument to equal "raw_output" for use in other analyses) or a plot ("plot"); default is to print ("print") the output to the console; can specify a vector of output to return</p></td>
    </tr>
    <tr>
      <th>test_all</th>
      <td><p>whether to carry out the sensitivity test for all of the coefficients (defaults to FALSE)</p></td>
    </tr>
    <tr>
      <th>two_by_two</th>
      <td><p>whether or not the tested variable is a dichotomous variable in a GLM; if so, the 2X2 table approach is used; only works for single variables at present (so test_all = TRUE will return an error)</p></td>
    </tr>
    <tr>
      <th>n_treat</th>
      <td><p>the number of cases associated with the treatment condition; applicable only when model_type = "logistic"</p></td>
    </tr>
    <tr>
      <th>switch_trm</th>
      <td><p>whether to switch the treatment and control cases; defaults to FALSE; applicable only when model_type = "logistic"</p></td>
    </tr>
    <tr>
      <th>replace</th>
      <td><p>whether using entire sample or the control group to calculate the base rate; default is the entire sample</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>prints the bias and the number of cases that would have to be replaced with cases for which there is no effect to invalidate the inference</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># using lm() for linear models</span>
<span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>wt</span> <span class='op'>+</span> <span class='va'>hp</span>, data <span class='op'>=</span> <span class='va'>mtcars</span><span class='op'>)</span>
<span class='fu'>konfound</span><span class='op'>(</span><span class='va'>m1</span>, <span class='va'>wt</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='font-weight: bold;'>Robustness of Inference to Replacement (RIR):
#&gt; </span><span>To invalidate an inference,  66.629 % of the estimate would have to be due to bias. 
#&gt; This is based on a threshold of -1.294 for statistical significance (alpha = 0.05).
#&gt; 
#&gt; To invalidate an inference,  21  observations would have to be replaced with cases
#&gt; for which the effect is 0 (RIR = 21).
#&gt; 
#&gt; See Frank et al. (2013) for a description of the method.
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Citation:</span><span> Frank, K.A., Maroulis, S., Duong, M., and Kelcey, B. (2013).
#&gt; What would it take to change an inference?
#&gt; Using Rubin's causal model to interpret the robustness of causal inferences.
#&gt; </span><span style='font-style: italic;'>Education, Evaluation and Policy Analysis, 35</span><span> 437-460.</div><div class='output co'>#&gt; <span class='message'>For more detailed output, consider setting `to_return` to table</span></div><div class='output co'>#&gt; <span class='message'>To consider other predictors of interest, consider setting `test_all` to TRUE.</span></div><div class='input'><span class='fu'>konfound</span><span class='op'>(</span><span class='va'>m1</span>, <span class='va'>wt</span>, test_all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Note that this output is calculated based on the correlation-based approach used in mkonfound()</span></div><div class='output co'>#&gt; <span class='warning'>Warning: row names were found from a short variable and have been discarded</span></div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 2 x 8</span><span>
#&gt;   var_name     t    df action     inference   pct_bias_to_change_in…  itcv r_con
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>    </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>                        </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span> wt       -</span><span style='color: #BB0000;'>6.13</span><span>    29 to_invali… reject_null                   52.7 0.614 0.784
#&gt; </span><span style='color: #555555;'>2</span><span> hp       -</span><span style='color: #BB0000;'>3.52</span><span>    29 to_invali… reject_null                   35.1 0.298 0.546</div><div class='input'><span class='fu'>konfound</span><span class='op'>(</span><span class='va'>m1</span>, <span class='va'>wt</span>, to_return <span class='op'>=</span> <span class='st'>"table"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependent variable is mpg </div><div class='output co'>#&gt; <span class='warning'>Warning: Unknown or uninitialised column: `itcv`.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Unknown or uninitialised column: `impact`.</span></div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 3 x 7</span><span>
#&gt;   term        estimate std.error statistic p.value   itcv impact
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>          </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span> (Intercept)   37.2       1.60      23.3    0     </span><span style='color: #BB0000;'>NA</span><span>     </span><span style='color: #BB0000;'>NA</span><span>    
#&gt; </span><span style='color: #555555;'>2</span><span> wt            -</span><span style='color: #BB0000;'>3.88</span><span>      0.633     -</span><span style='color: #BB0000;'>6.13</span><span>   0      0.626 </span><span style='color: #BB0000;'>NA</span><span>    
#&gt; </span><span style='color: #555555;'>3</span><span> hp            -</span><span style='color: #BB0000;'>0.032</span><span>     0.009     -</span><span style='color: #BB0000;'>3.52</span><span>   0.001 </span><span style='color: #BB0000;'>NA</span><span>      0.511</div><div class='input'>
<span class='co'># using glm() for non-linear models</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"forcats"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'>forcats</span><span class='fu'>::</span><span class='va'><a href='https://forcats.tidyverse.org/reference/gss_cat.html'>gss_cat</a></span>

  <span class='va'>d</span><span class='op'>$</span><span class='va'>married</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>$</span><span class='va'>marital</span> <span class='op'>==</span> <span class='st'>"Married"</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>

  <span class='va'>m2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>married</span> <span class='op'>~</span> <span class='va'>age</span>, data <span class='op'>=</span> <span class='va'>d</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span>link <span class='op'>=</span> <span class='st'>"logit"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'>konfound</span><span class='op'>(</span><span class='va'>m2</span>, <span class='va'>age</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required namespace: forcats</span></div><div class='output co'>#&gt; <span class='message'>Note that for a non-linear model, impact threshold should not be interpreted.</span></div><div class='output co'>#&gt; <span class='message'>Note that this is only an approximation. For exact results in terms of the number of cases that must be switched from treatment success to treatment failure to invalidate the inference see: https://msu.edu/~kenfrank/non%20linear%20replacement%20treatment.xlsm</span></div><div class='output co'>#&gt; <span class='message'>If a dichotomous independent variable is used, consider using the 2X2 table approach enabled with the argument two_by_two = TRUE</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(model[["call"]][["data"]], env): object 'd' not found</span></div><div class='input'>
<span class='co'># using lme4 for mixed effects (or multi-level) models</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"lme4"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/lme4/lme4/'>lme4</a></span><span class='op'>)</span>
  <span class='va'>m3</span> <span class='op'>&lt;-</span> <span class='va'>fm1</span> <span class='op'>&lt;-</span> <span class='fu'>lme4</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>Reaction</span> <span class='op'>~</span> <span class='va'>Days</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>Subject</span><span class='op'>)</span>, <span class='va'>sleepstudy</span><span class='op'>)</span>
  <span class='fu'>konfound</span><span class='op'>(</span><span class='va'>m3</span>, <span class='va'>Days</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required namespace: lme4</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='output co'>#&gt; <span class='message'>Registered S3 method overwritten by 'broom.mixed':</span>
#&gt; <span class='message'>  method      from </span>
#&gt; <span class='message'>  tidy.gamlss broom</span></div><div class='output co'>#&gt; </span><span style='font-weight: bold;'>Robustness of Inference to Replacement (RIR):
#&gt; </span><span>To invalidate an inference,  84.826 % of the estimate would have to be due to bias. 
#&gt; This is based on a threshold of 1.588 for statistical significance (alpha = 0.05).
#&gt; 
#&gt; To invalidate an inference,  137  observations would have to be replaced with cases
#&gt; for which the effect is 0 (RIR = 137).
#&gt; 
#&gt; See Frank et al. (2013) for a description of the method.
#&gt; 
#&gt; </span><span style='text-decoration: underline;'>Citation:</span><span> Frank, K.A., Maroulis, S., Duong, M., and Kelcey, B. (2013).
#&gt; What would it take to change an inference?
#&gt; Using Rubin's causal model to interpret the robustness of causal inferences.
#&gt; </span><span style='font-style: italic;'>Education, Evaluation and Policy Analysis, 35</span><span> 437-460.</div><div class='output co'>#&gt; <span class='message'>Note that the Kenward-Roger approximation is used to estimate degrees of freedom for the predictor(s) of interest. We are presently working to add other methods for calculating the degrees of freedom for the predictor(s) of interest. If you wish to use other methods now, consider those detailed here: https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#why-doesnt-lme4-display-denominator-degrees-of-freedomp-values-what-other-options-do-i-have. You can then enter degrees of freedom obtained from another method along with the coefficient, number of observations, and number of covariates to the pkonfound() function to quantify the robustness of the inference.</span></div><div class='output co'>#&gt; NULL</div><div class='input'>
<span class='va'>m4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>outcome</span> <span class='op'>~</span> <span class='va'>condition</span>, data <span class='op'>=</span> <span class='va'>binary_dummy_data</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span>link <span class='op'>=</span> <span class='st'>"logit"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>konfound</span><span class='op'>(</span><span class='va'>m4</span>, <span class='va'>condition</span>, two_by_two <span class='op'>=</span> <span class='cn'>TRUE</span>, n_treat <span class='op'>=</span> <span class='fl'>55</span><span class='op'>)</span>
</div><div class='output co'>#&gt; </span><span style='font-weight: bold;'>Conclusion:</span><span>
#&gt; </span><span style='text-decoration: underline;'>User-entered Table:</span><span>
#&gt;           Fail Success
#&gt; Control     36      16
#&gt; Treatment   18      37
#&gt; 
#&gt; 
#&gt; Note: Values have been rounded to the nearest integer.
#&gt; This may cause a little change to the estimated effect for the Implied Table.
#&gt; 
#&gt; To invalidate the inference, you would need to replace 14 treatment success cases
#&gt; with null hypothesis cases (RIR = 14).
#&gt; This is equivalent to transferring 10 cases from treatment success to treatment failure,
#&gt; as shown, from the Implied Table to the Transfer Table.
#&gt; </span><span style='text-decoration: underline;'>Transfer Table:</span><span>
#&gt;           Fail Success
#&gt; Control     36      16
#&gt; Treatment   18      37
#&gt; 
#&gt; For the Implied Table, we have an estimate of 1.531, with a SE of 0.416 and a t-ratio of 3.684.
#&gt; and a t-ratio of 1.531.
#&gt; </span><span style='font-weight: bold;'>RIR:</span><span>
#&gt; RIR = 14</div><div class='output co'>#&gt; NULL</div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joshua M Rosenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


